@using System.Linq
@using WebShop.Models
@model WebShop.Models.Order
@{
    ViewData["Title"] = "�?t h�ng th�nh c�ng";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<main class="main-content">
    <section class="order-confirmation spad">
        <div class="container">
            <div class="row">
                <div class="col-lg-10 offset-lg-1">
                    <div class="order-container">
                        <div class="order-header">
                            <div class="success-icon"></div>
                            <h1>�?t h�ng th�nh c�ng</h1>
                            <p class="order-id">M� don h�ng: <strong>#@Model.OrderId</strong></p>
                        </div>
                        <div class="order-content">
                            <div class="row">
                                <!-- Th�ng tin giao h�ng -->
                                <div class="col-lg-6 col-md-12">
                                    <div class="order-section">
                                        <h5>Th�ng tin giao h�ng</h5>
                                        <div class="info-list">
                                            <div class="info-item"><span class="label">Ngu?i nh?n:</span><span class="value">@(Model.ReceiverName ?? "Chua x�c d?nh")</span></div>
                                            <div class="info-item"><span class="label">�?a ch?:</span><span class="value">@(Model.Address ?? "")</span></div>
                                            <div class="info-item"><span class="label">T?nh/Th�nh:</span><span class="value">@(Model.Location?.Name ?? "Chua x�c d?nh")</span></div>
                                            <div class="info-item"><span class="label">Qu?n/Huy?n:</span><span class="value">@(ViewBag.QuanHuyen ?? "")</span></div>
                                            <div class="info-item"><span class="label">Phu?ng:</span><span class="value">@(ViewBag.PhuongXa ?? "")</span></div>
                                            <div class="info-item"><span class="label">Tr?ng th�i:</span><span class="value">@(Model.TransactStatus?.Status ?? "Chua c?p nh?t")</span></div>
                                        </div>
                                    </div>
                                </div>
                                <!-- Chi ti?t don h�ng -->
                                <div class="col-lg-6 col-md-12">
                                    <div class="order-section">
                                        <h5>Chi ti?t don h�ng</h5>
                                        @if (ViewBag.OrderDetails != null && ((List<WebShop.Models.OrderDetail>)ViewBag.OrderDetails).Any())
                                        {
                                            <table class="details-table">
                                                <thead>
                                                    <tr>
                                                        <th>S?n ph?m</th>
                                                        <th>S? lu?ng</th>
                                                        <th>�on gi�</th>
                                                        <th>T?ng</th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    @foreach (var item in (List<WebShop.Models.OrderDetail>)ViewBag.OrderDetails)
                                                    {
                                                        <tr>
                                                            <td class="product-info">
                                                                <div class="product__cart__item__pic">
                                                                    <img src="@Url.Content(item.ProductDetail?.Product?.Thumb ?? "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7")"
                                                                         alt="@(item.ProductDetail?.Product?.ProductName ?? "S?n ph?m")"
                                                                         loading="lazy">
                                                                </div>
                                                                <div class="product__cart__item__text">
                                                                    <a href="/Product/Detail/@item.ProductDetail.ProductId">@(item.ProductDetail?.Product?.ProductName ?? "N/A")</a>
                                                                </div>
                                                            </td>
                                                            <td>@item.Quantity</td>
                                                            <td>@(item.Price.HasValue ? string.Format("{0:N0}", item.Price.Value) : "0") VN�</td>
                                                            <td>@(item.Total.HasValue ? string.Format("{0:N0}", item.Total.Value) : "0") VN�</td>
                                                        </tr>
                                                    }
                                                </tbody>
                                            </table>
                                        }
                                        else
                                        {
                                            <p class="text-muted">Kh�ng c� chi ti?t don h�ng.</p>
                                        }
                                    </div>
                                </div>
                            </div>
                            <!-- T?ng quan -->
                            <div class="order-section mt-4">
                                <h5>T?ng quan</h5>
                                <div class="summary-wrapper">
                                    <table class="summary-table">
                                        @if (Model.TotalMoney.HasValue)
                                        {
                                            <tr><td class="label">T?m t�nh:</td><td class="value">@string.Format("{0:N0}", Model.TotalMoney + Model.TotalDiscount) VN�</td></tr>
                                            if (Model.VoucherId.HasValue && Model.Voucher != null)
                                            {
                                                <tr><td class="label">Voucher: (@Model.Voucher.VoucherCode):</td><td class="value">-@(Model.Voucher.DiscountType == "Percentage" ? $"{Model.Voucher.DiscountValue}%" : $"{string.Format("{0:N0}", Model.Voucher.DiscountValue)} VN�")</td></tr>
                                            }
                                            if (Model.PromotionId.HasValue && Model.Promotion != null)
                                            {
                                                <tr><td class="label">Khuy?n m�i: (@Model.Promotion.PromotionName):</td><td class="value">-@Model.Promotion.Discount%</td></tr>
                                            }
                                            <tr><td class="label">T?ng gi?m gi�:</td><td class="value">@string.Format("{0:N0}", Model.TotalDiscount) VN�</td></tr>
                                            <tr class="total-row"><td class="label total-label">T?ng ti?n:</td><td class="value total-amount">@string.Format("{0:N0}", Model.TotalMoney) VN�</td></tr>
                                        }
                                        else
                                        {
                                            <tr><td colspan="2" class="text-muted">Kh�ng c� th�ng tin t?ng quan.</td></tr>
                                        }
                                    </table>
                                </div>
                            </div>
                        </div>
                        <p class="text-muted mt-3">Ch�ng t�i s? x? l� don h�ng c?a b?n s?m nh?t c� th?. Theo d�i tr?ng th�i t?i "Danh s�ch don h�ng".</p>
                        <div class="text-center mt-4">
                            <a asp-controller="Accounts" asp-action="Dashboard" class="btn checkout-btn">Xem danh s�ch don h�ng</a>
                            <a asp-controller="Home" asp-action="Index" class="btn checkout-btn-black">Ti?p t?c mua s?m</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
</main>

<style>
    .order-confirmation.spad {
        padding: 40px 0;
        background-color: #f7fafc;
    }

    .order-container {
        background-color: #ffff;
        padding: 25px;
        border-radius: 10px;
        box-shadow: 0 4px 15px rgba(0,0,0,0.1);
    }

    .order-header {
        text-align: center;
        padding-bottom: 20px;
        border-bottom: 1px solid #e5e7eb;
        margin-bottom: 20px;
    }

    .success-icon {
        width: 60px;
        height: 60px;
        background-color: #FF6200;
        border-radius: 50%;
        margin: 0 auto 20px;
        position: relative;
    }

        .success-icon::after {
            content: "?";
            color: #ffffff !important; /* Corrected to proper white hex code */
            font-size: 30px;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-45%, -50%);
        }

    .order-header h1 {
        font-size: 28px;
        color: #1a202c;
        font-weight: 700;
        margin: 0 0 10px;
    }

    .order-id {
        font-size: 16px;
        color: #FF6200;
        margin: 0;
    }

        .order-id strong {
            color: #1a202c;
            font-weight: 600;
        }

    .order-content {
        padding: 0 15px;
    }

    .order-section {
        background-color: #fff;
        padding: 15px;
        border: 1px solid #e5e7eb;
        border-radius: 8px;
        margin-bottom: 20px;
    }

        .order-section h5 {
            font-size: 18px;
            font-weight: 600;
            color: #1a202c;
            margin-bottom: 15px;
        }

    .info-list {
        display: flex;
        flex-direction: column;
        gap: 10px; /* T�ch c�c d�ng ra */
    }

    .info-item {
        display: flex;
        justify-content: space-between;
        align-items: center;
    }

        .info-item .label {
            font-weight: 600;
            color: #1a202c;
            width: 120px; /* Gi?i h?n width label */
            text-align: left;
        }

        .info-item .value {
            color: #4a5568;
            flex-grow: 1;
            text-align: left;
        }

    .info-table, .summary-table {
        width: 100%;
        border-collapse: collapse;
    }

        .info-table td, .summary-table td {
            padding: 8px 12px;
            font-size: 14px;
            color: #4a5568;
        }

        .info-table .label, .summary-table .label {
            font-weight: 600;
            color: #1a202c;
            width: 280px; /* Tang width d? tr�nh xu?ng h�ng v� can d?u */
            text-align: left; /* Can tr�i label */
            padding-right: 20px;
        }

        .summary-table .value {
            text-align: left; /* Can tr�i value */
            white-space: nowrap; /* Ngan xu?ng h�ng */
            padding-left: 20px; /* Th�m kho?ng c�ch b�n tr�i cho value */
        }

        .summary-table .total-label {
            font-weight: 700;
            font-size: 16px;
        }

        .summary-table .total-amount {
            color: #e53e3e;
            font-weight: 700;
            font-size: 18px;
        }

    .summary-table {
        background-color: #f9fafb;
        border-radius: 8px;
        overflow: hidden;
        min-width: 500px; /* Tang width t?i thi?u d? can d?u */
        margin: 0 auto; /* Can gi?a b?ng */
    }

        .summary-table tr {
            border-bottom: 1px solid #e5e7eb;
            display: flex;
            justify-content: space-between; /* Can d?u label v� value */
            align-items: center;
        }

            .summary-table tr:last-child {
                border-bottom: none;
            }

    .total-row {
        background-color: #fff;
        font-size: 16px;
    }

    .details-table {
        width: 100%;
        border-collapse: collapse;
        background-color: #fff;
        border-radius: 8px;
        margin-top: 5px;
    }

        .details-table th,
        .details-table td {
            padding: 8px;
            text-align: center;
            border-bottom: 1px solid #e5e7eb;
            font-size: 13px;
            color: #4a5568;
        }

        .details-table thead th {
            background-color: #1a202c;
            color: #FFFFFF;
            font-weight: 500;
            text-transform: uppercase;
        }

        .details-table tbody tr:hover {
            background-color: #f7fafc;
        }

    .product__cart__item__pic img {
        width: 50px;
        height: 50px;
        object-fit: cover;
        border-radius: 6px;
        border: 1px solid #e5e7eb;
    }

    .product__cart__item__text {
        margin-left: 10px;
    }

        .product__cart__item__text a {
            color: #1a202c;
            text-decoration: none;
            font-weight: 600;
            font-size: 13px;
            transition: color 0.3s;
        }

            .product__cart__item__text a:hover {
                color: #FF6200;
            }

    .product-info {
        display: flex;
        align-items: center;
        text-align: left;
    }

    .text-muted {
        font-size: 14px;
        color: #718096;
        text-align: center;
    }

    .checkout-btn {
        background-color: #FF6200;
        border: none;
        border-radius: 6px;
        color: #FFFFFF;
        font-size: 16px;
        font-weight: 600;
        padding: 12px 30px;
        margin: 0 10px;
        transition: background-color 0.3s;
        text-decoration: none;
        display: inline-block;
    }

        .checkout-btn:hover {
            background-color: #CC4D00;
        }

    .checkout-btn-black {
        background-color: #000000;
        border: none;
        border-radius: 6px;
        color: #FFFFFF;
        font-size: 16px;
        font-weight: 600;
        padding: 12px 30px;
        margin: 0 10px;
        transition: background-color 0.3s;
        text-decoration: none;
        display: inline-block;
    }

        .checkout-btn-black:hover {
            background-color: #333333;
        }

    .summary-wrapper {
        padding: 15px;
        display: flex;
        justify-content: center;
    }

@@media (max-width: 991px) {
        .order-confirmation.spad

    {
        padding: 20px 0;
    }

    .order-container {
        padding: 15px;
    }

    .order-header {
        padding-bottom: 15px;
        margin-bottom: 15px;
    }

    .success-icon {
        width: 50px;
        height: 50px;
    }

        .success-icon::after {
            font-size: 25px;
        }

    .order-header h1 {
        font-size: 22px;
    }

    .order-id {
        font-size: 14px;
    }

    .order-section {
        padding: 10px;
        margin-bottom: 15px;
    }

    .info-item .label, .summary-table .label {
        width: 120px; /* Gi?m width tr�n mobile */
    }

    .summary-table {
        min-width: 300px; /* Gi?m width t?i thi?u tr�n mobile */
    }

    .details-table th,
    .details-table td {
        font-size: 11px;
        padding: 6px;
    }

    .product__cart__item__pic img {
        width: 40px;
        height: 40px;
    }

    .product__cart__item__text a {
        font-size: 11px;
    }

    .checkout-btn,
    .checkout-btn-black {
        font-size: 14px;
        padding: 8px 20px;
        margin: 5px;
    }

    }